
<!DOCTYPE html>
<html lang="en">
    <head>
    
        <title>FairyGUI - Input</title>
    
        <meta charset="utf-8">
        <meta name="description" content="FairyGUI Docs">
        <meta name="keywords" content="FairyGUI,FGUI,FairyGUI Docs">
        
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

        <meta property="og:type" content="article">
        <meta property="og:title" content="-InputFairyGUI">
        <meta property="og:description" content="FairyGUI Docs">

        <meta name="twitter:card" content="summary">
        <meta name="twitter:title" content="Input — FairyGUI">
        <meta name="twitter:description" content="FairyGUI Docs">

      <!--  <link href='//fonts.proxy.ustclug.org/css?family=Source+Sans+Pro:300,400,600|Roboto Mono' rel='stylesheet' type='text/css'> -->

        <!-- main page styles -->
        <link rel="stylesheet" href="/docs/css/page.css">

        <!-- this needs to be loaded before guide's inline scripts -->
        <script src="/docs/js/vue.min.js"></script>
        <script>window.PAGE_TYPE = "guide_unity"</script>
    </head>
    <body class="docs">        <div id="mobile-bar"  data-bg-text="FairyGUI" >
            <a class="menu-button"></a>
        </div>
        <div id="header">
  <ul id="nav">
    <li><a href="/docs/guide/" class="nav-link current">Manual</a></li>
<li><a href="/docs/examples/" class="nav-link">Examples</a></li>
<li><a href="/docs/release_notes/" class="nav-link">Release Notes</a></li>
<li><a href="/" class="nav-link">Home</a></li>
  </ul>
</div>

        
            <div id="main" class="fix-sidebar">
                
                    
    <div class="sidebar">
    <ul class="main-menu">
        <li><a href="/docs/guide/" class="nav-link current">Manual</a></li>
<li><a href="/docs/examples/" class="nav-link">Examples</a></li>
<li><a href="/docs/release_notes/" class="nav-link">Release Notes</a></li>
<li><a href="/" class="nav-link">Home</a></li>
    </ul>
    <div class="list">
        <ul class="menu-root">
            

	 			
	                
	                <li>
	                    <a href="/docs/guide/index.html" class="sidebar-link">Getting Start</a>
	                </li>
	            
	
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/index.html" class="sidebar-link">Basis</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/project_settings.html" class="sidebar-link">Project Settings</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/package.html" class="sidebar-link">Package</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/branch.html" class="sidebar-link">Branch</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/publish.html" class="sidebar-link">Publish</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/object.html" class="sidebar-link">Object</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/image.html" class="sidebar-link">Image</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/movieclip.html" class="sidebar-link">MovieClip</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/graph.html" class="sidebar-link">Graph</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/loader.html" class="sidebar-link">Loader</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/text.html" class="sidebar-link">Text</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/richtext.html" class="sidebar-link">Rich Text</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/group.html" class="sidebar-link">Group</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/component.html" class="sidebar-link">Component</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/scrollpane.html" class="sidebar-link">ScrollPane</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/controller.html" class="sidebar-link">Controller</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/relation.html" class="sidebar-link">Relation</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/label.html" class="sidebar-link">Label</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/button.html" class="sidebar-link">Button</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/combobox.html" class="sidebar-link">ComboBox</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/progressbar.html" class="sidebar-link">ProgressBar</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/slider.html" class="sidebar-link">Slider</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/scrollbar.html" class="sidebar-link">ScrollBar</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/list.html" class="sidebar-link">List</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/tree.html" class="sidebar-link">Tree</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/popup.html" class="sidebar-link">Popup</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/dragdrop.html" class="sidebar-link">Drag&Drop</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/window.html" class="sidebar-link">Window</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/transition.html" class="sidebar-link">Transition</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/adaptation.html" class="sidebar-link">Adaptation</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/i18n.html" class="sidebar-link">i18n</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/export.html" class="sidebar-link">Import/Export</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/preference.html" class="sidebar-link">Preference</a>
	                </li>
	            
	                
	                <li>
	                    <a href="/docs/guide/editor/plugin.html" class="sidebar-link">Plugin</a>
	                </li>
	            
	
	            
	                
	                
	                <li><h3>SDK</h3></li>
	                
	                <li>
	                    <a href="/docs/guide/sdk/laya.html" class="sidebar-link">LayaAir</a>
	                </li>
	            
	                
	                
	                <li>
	                    <a href="/docs/guide/sdk/egret.html" class="sidebar-link">Egret</a>
	                </li>
	            
	                
	                
	                <li>
	                    <a href="/docs/guide/sdk/cocos2dx.html" class="sidebar-link">Cocos2dx</a>
	                </li>
	            
	                
	                
	                <li>
	                    <a href="/docs/guide/sdk/creator.html" class="sidebar-link">Cocos Creator</a>
	                </li>
	            
	                
	                
	                <li>
	                    <a href="/docs/guide/sdk/cryengine.html" class="sidebar-link">Cry Engine</a>
	                </li>
	            

	            
	                
	                
	                <li><h3>SDK - Unity</h3></li>
	                
	                <li>
	                    <a href="/docs/guide/unity/index.html" class="sidebar-link">Basis</a>
	                </li>
	            
	                
	                
	                <li>
	                    <a href="/docs/guide/unity/transform.html" class="sidebar-link">Transform</a>
	                </li>
	            
	                
	                
	                <li>
	                    <a href="/docs/guide/unity/atlas.html" class="sidebar-link">Atlas</a>
	                </li>
	            
	                
	                
	                <li>
	                    <a href="/docs/guide/unity/font.html" class="sidebar-link">Fonts</a>
	                </li>
	            
	                
	                
	                <li>
	                    <a href="/docs/guide/unity/input.html" class="sidebar-link current">Input</a>
	                </li>
	            
	                
	                
	                <li>
	                    <a href="/docs/guide/unity/event.html" class="sidebar-link">Event</a>
	                </li>
	            
	                
	                
	                <li>
	                    <a href="/docs/guide/unity/insert3d.html" class="sidebar-link">Insert 3D</a>
	                </li>
	            
	                
	                
	                <li>
	                    <a href="/docs/guide/unity/uipainter.html" class="sidebar-link">Curved UI</a>
	                </li>
	            
	                
	                
	                <li>
	                    <a href="/docs/guide/unity/drawcall.html" class="sidebar-link">DrawCall</a>
	                </li>
	            
	                
	                
	                <li>
	                    <a href="/docs/guide/unity/lua.html" class="sidebar-link">Lua</a>
	                </li>
	            
	                
	                
	                <li>
	                    <a href="/docs/guide/unity/special.html" class="sidebar-link">Special</a>
	                </li>
	            
	                
	                
	                <li>
	                    <a href="/docs/guide/unity/faq.html" class="sidebar-link">FAQ</a>
	                </li>
	            

            
        </ul>
    </div>
</div>


<div class="content guide_unity with-sidebar ">
    
      <h1>Input</h1>
    
    <h2 id="Mouse-touch-input"><a href="#Mouse-touch-input" class="headerlink" title="Mouse / touch input"></a>Mouse / touch input</h2><p>FairyGUI uses built-in mechanisms for handling mouse and touch events, without using rays. If you really want to use rays, you can set the UIPanel’s “HitTest Mode” to “Raycast”. Regardless of the click detection mode, the following event processing mechanism is the same.</p>
<p>If you want to distinguish between clicking on the UI or clicking on objects in the scene, you can use the following methods:</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line"><span class="keyword">if</span> (Stage.isTouchOnUI) <span class="comment">// Click on the UI</span></div><div class="line">    &#123;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> <span class="comment">// no point on UI</span></div><div class="line">    &#123;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>This detection works not only for clicks but also for hovering. For example, this judgment is also true if the mouse is hovering over the UI. <strong>If you think there is no UI on the screen and this still returns true, then there is really a UI</strong>, Especially the full screen interface, when no penetration is set, its blank area also accepts input. You can check by printing GRoot.inst.touchTarget.</p>
<p>The mouse / touch related events are:</p>
<ul>
<li><code>onTouchBegin</code>The mouse button is pressed (left, middle, right), or the finger is pressed. Mouse buttons can be obtained from context.inputEvent.button, 0-left button, 1-middle button, 2-right button.</li>
<li><code>onTouchMove</code>The mouse pointer moves or your finger moves on the screen. There are only two cases of this event:<ul>
<li>If context.CaptureTouch () is called in onTouchBegin, subsequent movement events will be triggered on this object (regardless of whether the position of the finger or pointer is above the object).</li>
<li>The stage’s onTouchMove will always fire, Stage.inst.onTouchMove, it does not need to use CaptureTouch to capture. As long as the mouse is moved on the PC platform, it can be triggered; on the mobile platform, it is triggered only when the finger is pressed to move.</li>
</ul>
</li>
<li><code>onTouchEnd</code>The mouse button is released or your finger is off the screen. If the mouse or touch position is no longer within the scope of the component, then the component’s TouchEnd event will not be triggered. If it is really needed, you can call context.CaptureTouch () in onTouchBegin to request capture.</li>
<li><code>onClick</code>Mouse or finger click. You can determine whether you double-clicked from context.inputEvent.isDoubleClick.<strong>If you are looking for a long press event, then use LongPressGesture<a href="#手势">(Long press gesture)</a>。</strong><br> <strong>After the finger is pressed, if Stage.inst.CancelClick is called, the Click event will not be triggered when the finger is raised.</strong></li>
<li><code>onRightClick</code>Context.</li>
<li><code>onRollOver</code>Fired when the mouse or finger moves into an element.</li>
<li><code>onRollOut</code>Fired when the mouse or finger moves out of a component.</li>
</ul>
<p>You can get the current mouse or finger position and the clicked object in any event (that is, not just mouse / touch related events) callbacks, such as:</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">AnyEventHandler</span> (<span class="params">EventContext context</span>)</span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="comment">// Click the position, pay attention to the screen coordinates. To convert the local coordinates, use GlobalToLocal.</span></div><div class="line">        Debug.Log (context.inputEvent.x + <span class="string">","</span> + context.inputEvent.y);</div><div class="line"></div><div class="line">        <span class="comment">// Get the clicked object (in mouse / touch event)</span></div><div class="line">        Debug.Log ((GObject) context.sender);</div><div class="line">        <span class="comment">// If the event is bubbling, you can get the lowest level object. But note that the object type here is DisplayObject, not GObject.</span></div><div class="line">        Debug.Log ((DisplayObject) context.initiator);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>If you are not in the event and need to get the current mouse or finger position, you can use:</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line"><span class="comment">// This is the position of the mouse, or the position of the last finger</span></div><div class="line">    Vector2 pos1 = Stage.inst.touchPosition;</div><div class="line"></div><div class="line">    <span class="comment">// Get the specified finger position, the parameter is the finger id</span></div><div class="line">    Vector2 pos2 = Stage.inst.GetTouchPosition (<span class="number">1</span>);</div></pre></td></tr></table></figure>
<p>At any time, if you need to get the current clicked object, or the object under the mouse, you can get it in the following ways:</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line">GObject obj = GRoot.inst.touchTarget;</div><div class="line"></div><div class="line">    <span class="comment">// determine if it is in a certain component</span></div><div class="line">    Debug.Log (testComponent == obj || testComponent.IsAncestorOf (obj));</div></pre></td></tr></table></figure>
<h2 id="Multi-touch"><a href="#Multi-touch" class="headerlink" title="Multi-touch"></a>Multi-touch</h2><p>FairyGUI supports multi-touch processing. Each finger will dispatch events according to the TouchBegin-&gt; TouchMove-&gt; TouchEnd process. You can use EventContext.inputEvent.touchId to distinguish different fingers. In general, ordinary click events do not need to care about the finger id, only those that need to use the entire touch process need to be processed.</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line"><span class="comment">// This is the number of fingers currently pressed</span></div><div class="line">    <span class="keyword">int</span> touchCount = Stage.inst.touchCount;</div><div class="line"></div><div class="line">    <span class="comment">// Get all currently pressed finger ids</span></div><div class="line">    <span class="keyword">int</span> [] touchIDs = Stage.inst.GetAllTouch (<span class="literal">null</span>);</div></pre></td></tr></table></figure>
<p>If you don’t want to use the multi-touch function, you can use Unity’s API: Input.multiTouchEnabled = false to turn it off.</p>
<h2 id="VR-input-processing"><a href="#VR-input-processing" class="headerlink" title="VR input processing"></a>VR input processing</h2><p>The input in VR generally uses gaze input or handle input. For these new input methods, FairyGUI provides package support. That is to say, in VR applications, you can still handle VR input like mouse or touch input. No difference, which means that the UI logic does not need to be modified.</p>
<p>First, you need to pass these external inputs into FairyGUI. These APIs are provided in the Stage class:</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetCustomInput</span>(<span class="params"><span class="keyword">ref</span> RaycastHit hit, <span class="keyword">bool</span> buttonDown</span>)</span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetCustomInput</span>(<span class="params"><span class="keyword">ref</span> RaycastHit hit, <span class="keyword">bool</span> buttonDown, <span class="keyword">bool</span> buttonUp</span>)</span>;</div></pre></td></tr></table></figure>
<ul>
<li><p><code>hit</code>If there is no handle, here the ray hit by the eye (actually the ray of the camera) hits the target; if there is a handle, the ray hit by the input handle hits the target.</p>
</li>
<li><p><code>buttonDown</code>Is there a key press? For APIs without a buttonUp parameter, the system will automatically simulate a buttonUp in the next frame.</p>
</li>
<li><p><code>buttonUp</code>Whether any buttons are released. The whole process of pressing and releasing constitutes one click. If you only press and do not release, there will be no click trigger, you must pay attention to this.</p>
</li>
</ul>
<p>SetCustomInput can be called in Update and must be<strong>Called every frame</strong>。 If SetCustomInput is used, FairyGUI no longer processes mouse or touch input.</p>
<p>Example of use:</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line">SteamVR_TrackedObject controller;</div><div class="line">SteamVR_Controller.Device controllerDevice;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Start</span>(<span class="params"></span>)</span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    controller = ...</div><div class="line">    controllerDevice = ...</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Update</span>(<span class="params"></span>) </span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    Vector3 pos = controller.transform.position;</div><div class="line">    Vector3 dir = controller.transform.forward;</div><div class="line">    <span class="keyword">bool</span> trigger_down = controllerDevice.GetPress(Valve.VR.EVRButtonId.k_EButton_SteamVR_Trigger);</div><div class="line"></div><div class="line">    RaycastHit rh;</div><div class="line">    <span class="keyword">if</span> (Physics.Raycast(pos, dir, <span class="keyword">out</span> rh))</div><div class="line">    &#123;</div><div class="line">        Stage.inst.SetCustomInput(rh, trigger_down);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="keyboard-input"><a href="#keyboard-input" class="headerlink" title="keyboard input"></a>keyboard input</h2><p>To listen to keyboard input:</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line">Stage.inst.onKeyDown.Add(OnKeyDown);</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">OnKeyDown</span>(<span class="params">EventContext context</span>)</span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        Debug.Log(context.inputEvent.keyCode);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>On the phone, it is entered through the native keyboard. When the keyboard pops up, the GTextInput.onFocusIn event is dispatched, and when the keyboard is retracted, the GTextInput.onFocusOut event is dispatched.</p>
<p>Unity comes with an extra input box when typing on the keyboard. If you do n’t need this input box and want to pop up your own input box like WeChat, you need to write your own code.</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line"><span class="comment">// define your own keyboard</span></div><div class="line">    KeyBoard yourKeyboard;</div><div class="line"></div><div class="line">    Stage.inst.keyboard = yourKeyboard;</div></pre></td></tr></table></figure>
<p><strong>Copy-paste problem</strong></p>
<p>When using a plug-in in the form of a DLL, because the DLL is compiled for the mobile platform by default, copy and paste is not supported (if you want to support it, you need to write native code support yourself). If it is used on the PC platform,<a href="https://github.com/fairygui/FairyGUI-unity/blob/master/Examples.Unity5/Assets/FairyGUI/CopyPastePatch.cs" target="_blank" rel="external">CopyPastePatch.cs</a>Put it in the project, and call CopyPastePatch.Apply () when the game starts, you can activate the copy and paste function on the PC platform. <strong>If you are using a plugin in source form, you don’t need to do this.</strong></p>
<h2 id="gesture"><a href="#gesture" class="headerlink" title="gesture"></a>gesture</h2><p>FairyGUI provides gesture support. The ways to use gestures are:</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line">LongPressGesture gesture = <span class="keyword">new</span> LongPressGesture(targetObject);</div><div class="line">    gesture.onAction.Add(OnGestureAction);</div></pre></td></tr></table></figure>
<p>The targetObject is the component that receives the gesture. Note that it must be touchable. The image is not touchable, and it is generally recommended to use components or loaders. If you need to monitor gestures in full screen, you can directly use GRoot.inst as the targetObject (requires 1.9.0 SDK or later)</p>
<p>Common gestures are:</p>
<p><code>LongPressGesture</code>Long press gesture. You can set the time for the long press trigger, and you can also control the time interval for the notification to continue to be triggered after the long press trigger.</p>
<p><code>SwipeGesture</code>Finger swipe gesture.</p>
<p><code>PinchGesture</code>Two-finger zoom gesture.</p>
<p><code>RotationGesture</code>Two-finger rotation gesture.</p>
<p>Refer to Gesture Demo for gesture usage. Gestures are decoupled from the FairyGUI SDK. That is, if you do n’t think the gestures meet your requirements, you can copy one and use it yourself.</p>

    
    <div class="footer">
      found mistake? Want to participate in editing?
      <a href="https://github.com/fairygui/en.fairygui.io/tree/master/src/guide/unity/input.md" target="_blank">
        Edit this page on Github!
      </a>
    </div>
</div>

                
            </div>
            <script src="/docs/js/smooth-scroll.min.js"></script>
        

        <!-- main custom script for sidebars, version selects etc. -->        
        <script src="/docs/js/css.escape.js"></script>
        <script src="/docs/js/common.js"></script>
    </body>
</html>
